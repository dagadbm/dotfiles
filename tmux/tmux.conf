###############################################################################
# General

# note: press K inside vim (with tmuxplugins/vim-tmux installed) to jump to man definition of each of the tmux configurations!

# address vim mode switching delay
set -s escape-time 0

# increase scrollback buffer size
set -g history-limit 50000

# tmux messages are displayed for 4 seconds
set -g display-time 4000

# windows and panels start at 1 instead of 0
set -g base-index 1
set -g pane-base-index 1

set -g renumber-windows on
set -g allow-rename off
set -g set-titles on

set -g default-terminal "screen-256color"

set -g status-keys vi
setw -g mode-keys vi

set -g mouse on



setw -g monitor-activity on
set -g visual-activity on

# focus events enabled for terminals that support them (vim)
set -g focus-events on 

# super useful when using "grouped sessions" and multi-monitor setup
setw -g aggressive-resize on

# Sane splitting 
# pipe and underscore alias is also supported by plugins (see below)
bind-key v split-window -h
bind-key h split-window -v

# easier and faster switching between next/prev window
bind C-p previous-window
bind C-n next-window

bind-key x kill-pane
bind-key X kill-window

bind Enter copy-mode

# Easy config reload
bind-key R run-shell ' \
			tmux source-file ~/.tmux.conf > /dev/null; \
			tmux display-message "tmux.conf sourced."'


###############################################################################
# Plugins


set -g @plugin 'tmux-plugins/tpm'
# Tmux Plugin Manager
# To install plugins: Prefix + I
# To update plugins: Prefix + U
# To uninstall plugins (after removing from config): Prefix + alt + u
# scripts @ "~/.tmux/plugins/tpm/bin/clean_plugins"


set -g @plugin 'tmux-plugins/tmux-prefix-highlight'
# Shows on status bar if you pressed prefix or if you are in copy mode
# just add #{prefix_highlight} to status-left/right
#custom config
set -g @prefix_highlight_fg 'white' # default is 'colour231'
set -g @prefix_highlight_bg 'blue'  # default is 'colour04'
set -g @prefix_highlight_show_copy_mode 'on'
set -g @prefix_highlight_copy_mode_attr 'fg=black,bg=yellow,bold' # default is 'fg=default,bg=yellow'
set -g @prefix_highlight_prefix_prompt 'Prompt'
set -g @prefix_highlight_copy_prompt 'Copy'


set -g @plugin 'tmux-plugins/tmux-pain-control'
# adds vim like window movement. 
# | for vertical (\ full width) split
# - for horizontal ( _ full width) split


set -g @plugin 'tmux-plugins/tmux-copycat'
# Search with Prefix + / like in vim (use n N to navigate between results, Enter to copy result)


set -g @plugin 'tmux-plugins/tmux-yank'
# makes paste work properly using custom OS dependent clipboard.
# Each OS needs different external copy/paste handler plugin.
# See github documento for more info
# for macOSX this option is needed along with brew install reattach-to-user-namespace
set-option -g default-command "reattach-to-user-namespace -l $SHELL"


set -g @plugin 'tmux-plugins/tmux-resurrect'
# persists tmux session
# Prefix + Ctrl-s to save
# Prefix + Ctrl-r to restore
# sessions files stored in ~/.tmux/resurrect


set -g @plugin 'tmux-plugins/tmux-continuum'
# continuous saving of tmux sessions (built on top of tmux-resurrect)
# Tmux is automatically started after the computer/server is turned on.
set -g @continuum-boot 'on'
# start iterm2 in fullscreen
set -g @continuum-boot-options 'iterm,fullscreen'
# automatic restore tmux session
set -g @continuum-restore 'on'


set -g @plugin 'tmux-plugins/tmux-sessionist'
# easy tmux session management
# prefix + g - prompts for session name and switches to it. Performs 'kind-of' name completion.
# Faster than the built-in prefix + s prompt for long session lists.
# prefix + C (shift + c) - prompt for creating a new session by name.
# prefix + X (shift + x) - kill current session without detaching tmux.


set -g @plugin 'tmux-plugins/tmux-open'
# open files with open comand in copy mode
# o calls OS open command
set -g @open 'o'
# e edits the file using the $EDITOR
set -g @open-editor 'e'
# Shift-s searches the highlighted selection in google!


set -g @plugin 'nhdaly/tmux-better-mouse-mode'
# better mouse integration with tmux. check below options if behavior if weird
# look at the github repo for more info
set -g @scroll-down-exit-copy-mode "off" # default on
set -g @scroll-without-changing-pane "on" # default off
set -g @scroll-in-moused-over-pane "on" # default on
set -g @scroll-speed-num-lines-per-scroll "3" # default 3
set -g @emulate-scroll-for-no-mouse-alternate-buffer "on" # default off


set -g @plugin 'tmux-plugins/tmux-battery'
# Allows putting battery icons and notifications on the status-bar
set -g @batt_remain_short true


set -g @plugin 'tmux-plugins/tmux-sidebar'
# Tree like structure for tmux.
# use with Prefix + Tab/Backspace


###############################################################################
# Theme

set -g status-interval 1
set -g status-left-length 200
set -g status-right-length 200
set -g status-right '#{prefix_highlight} #{battery_icon} #{battery_percentage} #{battery_remain} | %a %d/%m/%Y   %H:%M:%S '
#set-window-option -g window-status-current-fg white
#set-window-option -g window-status-current-bg black

###############################################################################
# Bootstrap

# Auto Install TMUX plugin manager if it doesn't exist
if "test ! -d ~/.tmux/plugins/tpm" \
   "run 'git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm && ~/.tmux/plugins/tpm/bin/install_plugins'"

# Initialize TMUX plugin manager
run '~/.tmux/plugins/tpm/tpm'
